---
title: "Data Frames in R"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<style> p { text-align: justify; } </style>

## **What is a Data Frame?**

Data frames are a cornerstone of data manipulation and analysis in R, designed for handling tabular data efficiently. They are two-dimensional, rectangular structures where rows represent observations and columns represent variables. Each column is a vector of equal length, allowing for the storage of mixed data types such as numerical, character, or logical values. Analogous to spreadsheets or SQL tables, data frames are indispensable in tasks like statistical analysis, data visualization, and machine learning.

Key characteristics of data frames:

- Columns can contain different data types (e.g., numeric, character, factor).
- Rows represent individual observations or cases.
- Data frames can hold large datasets efficiently.

## **Creating Data Frames**

We can create a data frame in R using the `data.frame()` function from base R. Here's an example:

```{r create_df, message=FALSE, warning=FALSE, include=TRUE}

# Creating a data frame
students <- data.frame(
  Name = c("Amrit", "Ishwor", "Indra", "Rakshya"),
  Age = c(27, 24, 21, 25),
  Grade = c("A", "B", "A", "B"),
  Major = c("Maths", "Science", "Maths", "Science")
)

# Display the data frame
print(students)

```

## **Accessing and Modifying Data**

#### **Selecting Rows and Columns**

We can access elements of a data frame using indexing, column names, or logical conditions.

```{r access, message=FALSE, warning=FALSE, include=TRUE}

# Access a specific column
students$Name

# Access a specific row
students[1, ]

# Access a specific value
students[2, "Grade"]

```

#### **Adding and Removing Columns**

We can add a new column to a data frame dynamically or remove an existing column.

```{r modify, message=FALSE, warning=FALSE, include=TRUE}

# Adding a new column
students$Passed <- c(TRUE, FALSE, TRUE, FALSE)
# Display the data frame
print(students)

# Removing a column
students$Grade <- NULL
# Display the data frame
print(students)

```

## **Data Frame Operations**

#### **Filtering and Subsetting**

We can filter rows based on conditions using logical operators.

```{r filter, message=FALSE, warning=FALSE, include=TRUE}

# Filter students with Age > 22
students[students$Age > 22, ]
```

#### **Sorting and Reordering**

Sorting a data frame is straightforward with the `order()` function.

```{r reorder, message=FALSE, warning=FALSE, include=TRUE}

# Sort by Age
students <- students[order(students$Age), ]
# Display the data frame
print(students)

```

#### **Summary and Statistical Functions**

R provides built-in functions to summarize and analyze data frames.

```{r summary, message=FALSE, warning=FALSE, include=TRUE}

# Summary statistics
summary(students)

# Number of rows and columns
nrow(students)
ncol(students)

```

#### **Aggregation and Grouping**

The `dplyr` package functions enable grouping and summarization.

```{r group, message=FALSE, warning=FALSE, include=TRUE}

# Load dplyr package
library(dplyr)

# grouping
students %>%
  group_by(Major) %>%
  summarise(Average_Age = mean(Age))

```

So far, this chapter has introduced you to the versatility and power of data frames in R, laying the foundation for data manipulation and analysis. Now, we will delve into data frames specifically designed for geospatial data.

## **Geospatial Data Frames**

A Geospatial Data Frame (*GDF*) extends a standard data frame by including a geometry column, which stores spatial data in formats such as points, lines, and polygons. This integration of spatial and attribute data makes geospatial data frames ideal for spatial analysis and mapping.

The `sf` package represents geospatial data frames as `sf` objects, offering seamless compatibility with other R packages for geospatial and statistical analysis.

Geometry is central to geospatial data frames, defining the spatial features associated with each observation. Each row corresponds to a spatial feature with related attributes, and the geometry column typically stores spatial data in Well-Known Text (WKT) or binary format.

### **Creating GDF**

You can create a geospatial data frame using the st_as_sf() function from the sf package. Here's an example:

```{r sp_create, message=FALSE, warning=FALSE, include=TRUE}

library(sf)

# Create a data frame with spatial data
data <- data.frame(
  Name = c("Point A", "Point B", "Point C"),
  Latitude = c(27.7, 28.2, 26.9),
  Longitude = c(85.3, 84.9, 83.8)
)

# Convert to an sf object
geo_data <- st_as_sf(
  data,
  coords = c("Longitude", "Latitude"),
  crs = 4326  # WGS 84 Coordinate Reference System
)

print(geo_data)
```

### **Manipulating GDF**

#### **Spatial Queries**

Geospatial data frames support operations like spatial filtering and proximity analysis.

```{r sp_query, message=FALSE, warning=FALSE, include=TRUE}

# Define a bounding box and convert it to an sfc object
bbox <- st_bbox(c(xmin = 84, ymin = 27, xmax = 86, ymax = 29),
                crs = st_crs(geo_data))
bbox_polygon <- 
  st_as_sfc(bbox)

# Filter points within a specific bounding box
filtered_data <- 
  geo_data[st_within(geo_data,
                     bbox_polygon,
                     sparse = FALSE),
           ]

print(filtered_data)
```

#### **Attribute-Based Operations**

Just like standard data frames, we can manipulate attributes in geospatial data frames.

```{r sp_attribute, message=FALSE, warning=FALSE, include=TRUE}

# Add a new column
geo_data$Elevation <- 
  c(1500, 2000, 1700)

print(geo_data)
```

#### **Visualization of GDF**

Geospatial data frames can be visualized using the `plot()` function from the `sf` package or integrated with advanced visualization libraries such as `ggplot2`.

```{r sp_viz, message=FALSE, warning=FALSE, include=TRUE}

plot(geo_data["Name"],
     main = "Geospatial Data Points")
```

For enhanced visualization, we can use `geom_sf()` in ggplot2.

```{r sp_viz2, message=FALSE, warning=FALSE, include=TRUE}

library(ggplot2)

ggplot(data = geo_data) +
  geom_sf(aes(color = Name), size = 3) +
  labs(title = "Geospatial Data Points") +
  theme_minimal()
```

This approach allows you to set individual colors based on the Name attribute or other properties and provides more control over styling.

Geospatial data frames bridge the gap between tabular data and spatial analysis, making them indispensable for modern geospatial workflows. Their versatility, combined with Râ€™s ecosystem of geospatial packages, provides an efficient and intuitive way to analyze and visualize spatial data.
